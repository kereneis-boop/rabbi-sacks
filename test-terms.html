<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Terms_1.3 – Rabbi Sacks</title>
  <style>
    html, body { margin: 0; }
    .vbt-terms * { box-sizing: border-box; }

    /* אקורדיון (checkbox) */
    .vbt-terms .vbt-acc { position: relative; border-radius: 18px; padding: 0; background: transparent; }
    .vbt-terms .vbt-toggle { position: absolute; inset: 0; opacity: 0; pointer-events: none; }

    .vbt-terms .vbt-summary {
      display: flex; /* חזרה ל-flex בשביל יישור מושלם בשורה אחת */
      align-items: center; justify-content: space-between; gap: 12px;
      direction: rtl; cursor: pointer;
      padding: 14px 18px; border-radius: 40px; background: #F8E8FF; font-weight: 800; font-size: 18px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.6), inset 0 0 0 1px rgba(0,0,0,.04);
      list-style: none; outline: none; transition: box-shadow .35s ease, transform .2s ease, background-color .3s ease;
      min-height: 56px; line-height: 1; /* שורה אחת קומפקטית */
    }
    .vbt-terms .vbt-summary > * { align-self: center; }
    .vbt-terms .vbt-summary > .vbt-icon { order: 1; flex: 0 0 auto; align-self: center; }
    .vbt-terms .vbt-summary > .vbt-pm { order: 3; flex: 0 0 auto; align-self: center; }
    .vbt-terms .vbt-title { order: 2; flex: 1 1 auto; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-align: center; }
    .vbt-terms .vbt-summary:hover { transform: translateY(-1px); }
    .vbt-terms .vbt-summary:focus-visible { outline: 2px solid #fe0100; outline-offset: 2px; }
    /* פתיחה: הקפסולה מתחלפת לירקרק */
    .vbt-terms .vbt-toggle:checked + .vbt-summary { background: #D7F6E4; box-shadow: 0 6px 16px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.6), inset 0 0 0 1px rgba(0,0,0,.04); }

    /* אייקון i – אדום בסגור, ירוק וסיבוב בפתוח */
    .vbt-terms .vbt-icon {
      width: 28px; height: 28px; border-radius: 50%; background: #fe0100; color: #fff; display: grid; place-items: center; font-weight: 900; transition: transform .35s ease, background-color .3s ease;
    }
    .vbt-terms .vbt-toggle:checked + .vbt-summary .vbt-icon { background: #69DA98; transform: rotate(180deg); }

    /* + / − – בקצה שמאל (ללא JS) */
    .vbt-terms .vbt-pm {
      grid-column: 3; justify-self: start;
      width: 32px; height: 32px; display: inline-flex; align-items: center; justify-content: center;
      font-size: 24px; line-height: 1; font-weight: 900;
    }
    .vbt-terms .vbt-pm::before { content: '+'; }
    .vbt-terms .vbt-toggle:checked + .vbt-summary .vbt-pm::before { content: '−'; }

    .vbt-terms .vbt-panel {
      margin-top: 10px; background: #D7F6E4; border-radius: 14px; padding: 0 16px; line-height: 1.55;
      max-height: 0; overflow: hidden; opacity: 0; transform: translateY(-6px);
      transition: max-height .5s ease, opacity .45s ease, transform .45s ease, padding .45s ease;
    }
    .vbt-terms .vbt-toggle:checked ~ .vbt-panel { padding: 16px; opacity: 1; transform: translateY(0); max-height: 4000px; }

    .vbt-terms .vbt-grid { display: grid; grid-template-columns: 1fr; gap: 18px; max-width: 1000px; margin: 0 auto; }
    @media (min-width: 700px) { .vbt-terms .vbt-grid { grid-template-columns: repeat(2, minmax(0,1fr)); } }

    @media (prefers-reduced-motion: reduce) { .vbt-terms .vbt-panel, .vbt-terms .vbt-icon, .vbt-terms .vbt-summary { transition: none; } }
  </style>
</head>
<body>
  <div class="vbt-terms" dir="rtl" style="max-width:1120px;margin:0 auto;font-family: Alef,-apple-system,'Segoe UI',Arial,sans-serif;color:#0f172a;">
    <div class="vbt-grid">

      <!-- ===== הרב סולובייצ'יק ===== -->
      <div class="vbt-acc" data-test-id="acc-1">
        <input class="vbt-toggle" type="checkbox" id="vbt-t1" />
        <label class="vbt-summary" for="vbt-t1" role="button" tabindex="0" data-test-id="btn-1">
          <span class="vbt-pm" aria-hidden="true"></span>
          <span class="vbt-title" style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">הרב סולובייצ'יק</span>
          <span class="vbt-icon" aria-hidden="true">i</span>
        </label>
        <div class="vbt-panel" data-test-id="panel-1">
          הרב יוסף דב סולובייצ'יק היה מההוגים היהודיים המשפיעים ביותר במאה העשרים, יצר סינתזה ייחודית בין המסורת היהודית לפילוסופיה המערבית. הוא פיתח את דמות "איש ההלכה" המשלבת בין עולם המסורת לעולם המודרני, וטבע את המושג "קהילת הברית" המדגיש את האחריות ההדדית בקהילה היהודית. השפעתו על הרב זקס ניכרת בניסיון המתמיד לגשר בין המסורת למודרנה, בחשיבות הקהילה, ובחתירה למצוא משמעות יהודית עמוקה לאתגרי הזמן.
        </div>
      </div>

      <!-- ===== הרבי מלובביץ' ===== -->
      <div class="vbt-acc" data-test-id="acc-2">
        <input class="vbt-toggle" type="checkbox" id="vbt-t2" />
        <label class="vbt-summary" for="vbt-t2" role="button" tabindex="0" data-test-id="btn-2">
          <span class="vbt-pm" aria-hidden="true"></span>
          <span class="vbt-title" style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">הרבי מלובביץ'</span>
          <span class="vbt-icon" aria-hidden="true">i</span>
        </label>
        <div class="vbt-panel" data-test-id="panel-2">
          המנהיג השביעי והאחרון של חסידות חב"ד, היה מגדולי ההוגים והמנהיגים היהודיים במאה העשרים, שהיה ידוע בהשכלתו הרחבה הן בתורה והן במדעים. הוא היווה השראה לרב זקס בראייתו את האפשרות לשלב בין יהדות מסורתית למעורבות מלאה בעולם המודרני, ובמנהיגותו ששילבה בין נאמנות עמוקה למסורת היהודית לבין פתיחות ואחריות כלפי כלל האנושות.
        </div>
      </div>

    </div>
  </div>

  <!-- Auto‑Resize + Dynamic MaxHeight (Campus/Moodle) -->
  <script>
  (function () {
    function computeHeight(){
      var b = document.body, d = document.documentElement;
      return Math.max(d.scrollHeight, b.scrollHeight, d.offsetHeight, b.offsetHeight, d.clientHeight, b.clientHeight);
    }
    function sendHeight(){ try { parent.postMessage({ type: 'termsHeight', height: Math.ceil(computeHeight()) }, '*'); } catch(e){} }
    function burst(ms){ var end=Date.now()+(ms||800); (function step(){ sendHeight(); if(Date.now()<end) requestAnimationFrame(step); })(); }

    // ==== Dynamic panel heights to avoid inner scrolling (and still animate)
    function setPanelHeight(acc){
      var cb = acc.querySelector('.vbt-toggle');
      var p = acc.querySelector('.vbt-panel');
      if(!cb || !p) return;
      if (cb.checked) {
        p.style.maxHeight = 'none';
        var target = p.scrollHeight;
        p.style.maxHeight = target + 'px';
        var onEnd = function(e){ if(e.propertyName === 'max-height'){ p.style.maxHeight = 'none'; p.removeEventListener('transitionend', onEnd); sendHeight(); } };
        p.addEventListener('transitionend', onEnd);
      } else {
        if (p.style.maxHeight === 'none') { p.style.maxHeight = p.scrollHeight + 'px'; void p.offsetHeight; }
        p.style.maxHeight = '0px';
      }
    }
    function applyHeights(){ document.querySelectorAll('.vbt-acc').forEach(setPanelHeight); }

    if ('ResizeObserver' in window) {
      var ro = new ResizeObserver(function(){ requestAnimationFrame(function(){ applyHeights(); sendHeight(); }); });
      ro.observe(document.documentElement);
      ro.observe(document.body);
      var root = document.querySelector('.vbt-terms'); if (root) ro.observe(root);
      var grid = document.querySelector('.vbt-grid'); if (grid) ro.observe(grid);
      document.querySelectorAll('.vbt-panel, .vbt-summary').forEach(function(el){ ro.observe(el); });
    }

    if ('MutationObserver' in window) {
      var mo = new MutationObserver(function(){ setTimeout(function(){ applyHeights(); sendHeight(); }, 80); });
      mo.observe(document.documentElement, { attributes:true, childList:true, subtree:true });
    }

    function tick(){ requestAnimationFrame(function(){ applyHeights(); sendHeight(); }); }
    window.addEventListener('DOMContentLoaded', tick);
    window.addEventListener('load', tick);
    window.addEventListener('transitionrun', function(){ burst(700); }, true);
    window.addEventListener('transitionend', function(){ setTimeout(function(){ applyHeights(); sendHeight(); }, 80); }, true);
    window.addEventListener('change', function(e){ if (e.target && e.target.classList && e.target.classList.contains('vbt-toggle')) { applyHeights(); burst(800); } }, true);
    window.addEventListener('click', function(){ setTimeout(sendHeight, 140); }, true);

    var hb = setInterval(sendHeight, 1800);
    window.addEventListener('pagehide', function(){ clearInterval(hb); });

    // initial
    applyHeights();
    sendHeight();

    /* =====================
       🧪 בדיקות ידניות – הפעלה מקונסול: runTermsTests();
       לא משנות מצב קבוע בדף.
    ===================== */
    function assert(cond, msg) { if (!cond) throw new Error('Test failed: ' + msg); }
    window.runTermsTests = function(){
      var acc = document.querySelector('[data-test-id="acc-1"]');
      var btn = document.querySelector('[data-test-id="btn-1"]');
      var panel = document.querySelector('[data-test-id="panel-1"]');
      var cb = acc.querySelector('.vbt-toggle');
      var pm = btn.querySelector('.vbt-pm');
      var icon = btn.querySelector('.vbt-icon');
      function pseudo(el){ var c = getComputedStyle(el, '::before').content || ''; return c.replace(/^(["'])|(["'])$/g,''); }

      assert(!!acc && !!btn && !!panel && !!cb, 'אלמנטים קיימים');
      assert(!cb.checked, 'ברירת מחדל: סגור');
      assert(pseudo(pm) === '+', 'בסגור: + מוצג');

      // מיקום: i בימין, + בשמאל
      var rPlus = pm.getBoundingClientRect();
      var rI = icon.getBoundingClientRect();
      assert(rPlus.left < rI.left, '+ משמאל ל-i');

      // פתיחה
      cb.checked = true; cb.dispatchEvent(new Event('change', {bubbles:true}));
      applyHeights();
      assert(pseudo(pm) === '−', 'בפתוח: −');

      // הפאנל גדל (maxHeight > 0 או none אחרי האנימציה)
      var mhOpen = getComputedStyle(panel).maxHeight;
      assert(mhOpen === 'none' || /px$/.test(mhOpen), 'בפתוח: max-height תקין (none/px)');

      // סגירה
      cb.checked = false; cb.dispatchEvent(new Event('change', {bubbles:true}));
      applyHeights();
      var mhClosed = getComputedStyle(panel).maxHeight;
      assert(mhClosed === '0px', 'בסגירה: max-height = 0px');

      console.log('All Terms tests passed ✅');
    };
  })();
  </script>
</body>
</html>
